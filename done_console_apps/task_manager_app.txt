using System;
using System.Linq;
using System.Collections.Generic;

namespace App
{
    class Program
    {
        static void Main(string[] args)
        {
            List<string> userTasks = new List<string>();
            bool programIsRunning = true;
            while (programIsRunning == true)
            {
                Console.WriteLine("Welcome to the task manager, please choose your action");
                Console.WriteLine("1. Add Task ; 2. Remove Task ; 3. Edit Task ; 4. Clear All Tasks ; 5.Show Tasks");
                int selectedOption;
                while (!int.TryParse(Console.ReadLine(), out selectedOption))
                {
                    Console.Write("You did not enter a number, try again :");
                }
                if (selectedOption == 1)
                {
                    Console.Write("Write the task to add : ");
                    string? task = Console.ReadLine();
                    if (task is null)
                    {
                        Console.WriteLine("(You did not write anything)");
                        throw new NullReferenceException();
                    }
                    userTasks.Add(task);
                    Console.Write("Task added successfully !");
                }
                else if (selectedOption == 2)
                {
                    Console.WriteLine("Please write the number of the task you want to remove :");
                    for (int i = 0; i < userTasks.Count; i++)
                    {
                        Console.WriteLine($"{i}. {userTasks[i]}");
                    }
                    int userChoice;
                    while (!int.TryParse(Console.ReadLine(), out userChoice))
                    {
                        Console.Write("You did not enter a number, try again :");
                    }
                    userTasks.Remove(userTasks[userChoice]);
                    Console.Write("Task removed successfully !");
                }
                else if (selectedOption == 3)
                {
                    Console.WriteLine("Please write the number of the task you want to edit");
                    for (int i = 0; i < userTasks.Count; i++)
                    {
                        Console.WriteLine($"{i}. {userTasks[i]}");
                    }
                    int userNumber;
                    while (!int.TryParse(Console.ReadLine(), out userNumber))
                    {
                        Console.Write("You did not enter a number, try again :");
                    }
                    Console.Write("Write the edited task : ");
                    string? editedTask = Console.ReadLine();
                    if (editedTask is null)
                    {
                        Console.WriteLine("(You did not write anything)");
                        throw new NullReferenceException();
                    }
                    userTasks[userNumber] = editedTask;
                    Console.WriteLine("Task Edited successfully !");
                }
                else if (selectedOption == 4)
                {
                    userTasks.Clear();
                    Console.WriteLine("Tasks cleared successfully");
                }
                else if (selectedOption == 5)
                {
                    for (int i = 0; i < userTasks.Count; i++)
                    {
                        Console.WriteLine($"{i}. {userTasks[i]}");
                    }
                }

                Console.WriteLine("Would you like to do anything else ? Y / N");
                string? userAgreement = Console.ReadLine();
                if (userAgreement == "Y")
                {
                    continue;
                }
                else
                {
                    programIsRunning = false;
                    Console.WriteLine("Thank you for using the task manager app.");
                    break;
                }
            }
        }
    }
}